<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8" />


    <title>Labelling dataviz</title>








    <meta name="author" content="kearneymw" />
    <meta name="description" content="I still remember how hard it was to learn {ggplot2} after only knowing a little about R1. Sure, the plots seemed pretty. But compared to the ways I had used R before, {ggplot2}’s syntax seemed almost counter-intuitive. Its pipe-like &#43; workflow–building layer-by-layer– was like nothing I had ever used before. Not to mention, I was unfamiliar with central terms of art like “geoms” and “aesthetics”.
But then again…the plots were really pretty." />



    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@kearneymw" />
    <meta name="twitter:title" content="Labelling dataviz" />
    <meta name="twitter:description" content="I still remember how hard it was to learn {ggplot2} after only knowing a little about R1. Sure, the plots seemed pretty. But compared to the ways I had used R before, {ggplot2}’s syntax seemed almost counter-intuitive. Its pipe-like &#43; workflow–building layer-by-layer– was like nothing I had ever used before. Not to mention, I was unfamiliar with central terms of art like “geoms” and “aesthetics”.
But then again…the plots were really pretty." />
    <meta name="twitter:image" content="/img/avatar.jpg" />





    <meta name="generator" content="Hugo 0.40.1" />


    <link rel="canonical" href="../../post/2018-09-20-labelling-dataviz/" />
    <link rel="alternative" href="../../index.xml" title="Michael W. Kearney"
        type="application/atom+xml" />


    <meta name="renderer" content="webkit" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="format-detection" content="telephone=no,email=no,adress=no" />
    <meta http-equiv="Cache-Control" content="no-transform" />


    <meta name="robots" content="index,follow" />
    <meta name="referrer" content="origin-when-cross-origin" />
    <meta name="google-site-verification"
        content="XjRg6K6oRqzExBrXKJh8Z2BrPJsc9WCVNOEWvhN68oY" />






    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style"
        content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Michael W. Kearney" />
    <meta name="msapplication-tooltip" content="Michael W. Kearney" />
    <meta name='msapplication-navbutton-color' content="#5fbf5e" />
    <meta name="msapplication-TileColor" content="#5fbf5e" />
    <meta name="msapplication-TileImage"
        content="/img/tile-image-windows.png" />
    <link rel="icon" href="../../img/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16"
        href="../../img/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32"
        href="../../img/favicon-32x32.png" />
    <link rel="icon" sizes="192x192" href="../../img/touch-icon-android.png" />
    <link rel="apple-touch-icon" href="../../img/touch-icon-apple.png" />
    <link rel="mask-icon" href="../../img/safari-pinned-tab.svg"
        color="#5fbf5e" />



    <link rel="stylesheet"
        href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

    <link rel="stylesheet" href="../../css/bundle.css" />
    <link rel="stylesheet" href="../../highlight/styles/atom-one-light.css" />


    <link rel="stylesheet" href="../../css/custom.css">


    <link
        href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,700|Source+Code+Pro"
        rel="stylesheet">



    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

    <!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


    <script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


    <script
        src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>

<body>

    <div class="suspension">
        <a title="Go to top" class="to-top is-hide"><span
                class="icon icon-up"></span></a>


        <a title="Go to comments" class="to-comment" href="#disqus_thread"><span
                class="icon icon-comment"></span></a>


    </div>


    <header class="site-header">
        <a class="avatar_link" href="../../"><img class="avatar"
                src="../../img/aintnoseats.jpeg" alt="Avatar"></a>

        <h2 class="title">Michael W. Kearney</h2>

        <p class="subtitle">Senior AI/Data Scientist<br>
            NLP – Machine Learning<br>
            Python – R – SQL – Bash – Git<br>
            Responsible AI – Creative Solutions</p>
        <button class="menu-toggle" type="button">
            <span class="icon icon-menu"></span>
        </button>
        <nav class="site-menu collapsed">
            <h2 class="offscreen">Main Menu</h2>
            <ul class="menu-list">




                <li class="menu-item  is-active"><a href="../../">Home</a></li>

                <li class="menu-item "><a href="../../about/">About</a></li>

                <li class="menu-item "><a
                        href="../../publications/">Publications</a></li>

                <li class="menu-item "><a href="https://cv.mikewk.com">CV</a>
                </li>

            </ul>
        </nav>
        <nav class="social-menu collapsed">
            <h2 class="offscreen">Social Networks</h2>
            <ul class="social-list">


                <li class="social-item">
                    <a href="mailto:kearneymw@missouri.edu" title="Email"><span
                            class="icon icon-email"></span></a>
                </li>


                <li class="social-item">
                    <a href="//github.com/mkearney" title="GitHub"><span
                            class="icon icon-github"></span></a>
                </li>

                <li class="social-item">
                    <a href="//twitter.com/kearneymw" title="Twitter"><span
                            class="icon icon-twitter"></span></a>
                </li>

                <li class="social-item">
                    <a href="//www.facebook.com/mike.wayne.kearney"
                        title="Facebook"><span
                            class="icon icon-facebook"></span></a>
                </li>



























                <li class="social-item">
                    <a href="//www.linkedin.com/in/mikewk"
                        title="Linkedin"><span
                            class="icon icon-linkedin"></span></a>
                </li>







                <li class="social-item">
                    <a href="../../index.xml"><span class="icon icon-rss"
                            title="RSS"></span></a>
                </li>

            </ul>
        </nav>
    </header>

    <section class="main post-detail">
        <header class="post-header">
            <h1 class="post-title">Labelling dataviz</h1>
            <p class="post-meta">@kearneymw · Sep 20, 2018 · 6 min read</p>
        </header>
        <article class="post-content">
            <p>I still remember how hard it was to learn <a
                    href="https://ggplot2.tidyverse.org">{ggplot2}</a>
                after only knowing a little about R<sup>1</sup>. Sure, the plots
                seemed pretty.
                But compared to the ways I had used R before,
                <code>{ggplot2}</code>’s syntax seemed almost
                counter-intuitive. Its pipe-like <code>+</code>
                workflow–building layer-by-layer–
                was like nothing I had ever used before. Not to mention, I was
                unfamiliar
                with central terms of art like “<code>geom</code>s” and
                “<code>aes</code>thetics”.
            </p>
            <p>But then again…the plots were <strong>really pretty</strong>.</p>
            <p>Fortunately for me, <em>being able to generate pretty plots</em>
                was a powerful
                motivator. Because not long after committing myself to learning
                how to <code>{ggplot2}</code>,
                I realized why everyone likes it so much–it’s actually really
                easy! Once I learned about the key building blocks of
                <code>ggplot()</code>, <code>aes()</code>,
                and <code>geom_.*()</code>), I could create pretty plots for all
                sorts of data types and
                relationships.
            </p>
            <div id="its-in-the-details" class="section level3">
                <h3>It’s in the details</h3>
                <p>Over time my <a
                        href="https://twitter.com/search?q=%23rstats%20%23dataviz&amp;src=typed_query&amp;f=image">#dataviz</a>
                    has <a
                        href="https://twitter.com/kearneymw/status/762833157578162180/photo/1">gotten</a>
                    a lot <a
                        href="https://twitter.com/kearneymw/status/1040702237310365701/photo/1">better</a>,
                    but it’s had very little
                    to do the actual plotting of data points
                    (<code>{ggplot2}</code> outputs beautiful plots by
                    default). Instead, my dataviz has improved because I learned
                    how to (a) more
                    effectively label scales, data points, and other dimensions
                    of a plot and (b)
                    (re)size and save high-resolution plots using nice-looking
                    fonts.</p>
                <p>With this in mind, my goal with this post is to demonstrate
                    how data
                    visualizations can be improved via proper labelling. And
                    since this idea was
                    inspired by my <a
                        href="../2018-09-17-tick-marks-var-names-and-ggplot2">last
                        post</a>,
                    I will extend the example about the relationship between
                    miles per gallon and
                    number of cylinders. If you read the setup section from the
                    last post, you can
                    skip ahead (it’s the same).</p>
            </div>
            <div id="setup" class="section level2">
                <h2>Setup</h2>
                <p>To follow along with the examples in this post, you will need
                    to load the
                    <a href="https://tidyverse.org">{tidyverse}</a> set of
                    packages and define a couple stylistic
                    functions used throughout to make the plots even prettier.
                </p>
                <pre class="r"><code>## load tidyverse
library(tidyverse)
#&gt; ── Attaching packages ───────────────────────────────────────────────────── tidyverse 1.2.1 ──
#&gt; ✔ ggplot2 3.0.0.9000     ✔ purrr   0.2.5
#&gt; ✔ tibble  1.4.2          ✔ dplyr   0.7.6
#&gt; ✔ tidyr   0.8.1          ✔ stringr 1.3.1
#&gt; ✔ readr   1.1.1          ✔ forcats 0.3.0
#&gt; ── Conflicts ──────────────────────────────────────────────────────── tidyverse_conflicts() ──
#&gt; ✖ dplyr::filter() masks stats::filter()
#&gt; ✖ dplyr::lag()    masks stats::lag()

## create style theme
my_theme &lt;- function() {
  theme_minimal(base_family = &quot;Roboto Condensed&quot;) +
    theme(plot.title = element_text(size = rel(1.5), face = &quot;bold&quot;),
      plot.subtitle = element_text(size = rel(1.1)),
      plot.caption = element_text(color = &quot;#777777&quot;, vjust = 0),
      axis.title = element_text(size = rel(.9), hjust = 0.95, face = &quot;italic&quot;),
      panel.grid.major = element_line(size = rel(.1), color = &quot;#000000&quot;),
      panel.grid.minor = element_line(size = rel(.05), color = &quot;#000000&quot;),
      legend.position = &quot;none&quot;)
}
my_labs &lt;- function() {
  labs(title = &quot;Average miles per gallon by number of cylinders&quot;,
    subtitle = &quot;Scatter plot depicting average miles per gallon aggregated by number of cylinders&quot;,
    x = &quot;Number of cylinders&quot;, y = &quot;Miles per gallon&quot;,
    caption = &quot;Source: Estimates calculated from the &#39;mtcars&#39; data set&quot;)
}
my_save &lt;- function(file) {
  ggsave(file, width = 7, height = 4.5, units = &quot;in&quot;)
}</code></pre>
                <p>The data set featured in this post is
                    <strong>mtcars</strong>, which is bundled as part of
                    the core <a
                        href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html">datasets</a>
                    package. Specifically, examples will feature the
                    <code>mpg</code> (miles per gallon)
                    and <code>cyl</code> (number of cylinders) variables.
                </p>
                <pre
                    class="r"><code>## print first six rows
head(mtcars)
#&gt;                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
#&gt; Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
#&gt; Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
#&gt; Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
            </div>
            <div id="labelling-dataviz" class="section level2">
                <h2>Labelling dataviz</h2>
                <p>I think most would agree a <em>good</em> data visualization
                    clearly
                    conveys a pattern (or lack of pattern) while being easy to
                    understand, while a
                    <em>great</em> data visualization conveys a pattern (or lack
                    of pattern) while
                    being easy to understand <strong>and aesthetically
                        pleasing</strong>. The difference between
                    <em>good</em> and <em>great</em> can be something as minor
                    as color palette, but, in my
                    experience, more often than not the only difference between
                    a good visualization
                    and great visualizations is labelling.
                </p>
                <p>In my last post, for example, the first successful plot of
                    <code>mpg</code> by <code>cyl</code> was
                    only <em>okay</em>–it’s a little bland and it uses an actual
                    expression for an axis title.
                </p>
                <p style="align:center">
                    <img src="../../img/tick-marks.png">
                </p>
                <p>But then I replaced the expression and added a custom theme
                    and a few more labels,
                    and I think it started to border on being <em>good</em>.</p>
                <p style="align:center">
                    <img src="../../img/with-labs.png">
                </p>
                <p>The combination of style changes and labels clearly made a
                    big difference but, still,
                    I don’t think the above plot is mind-blowing or overly
                    impressive.</p>
                <p>Since there aren’t <em>that</em> many data points, I think
                    this visualization can be
                    further improved–with the help of <a
                        href="https://github.com/slowkow/ggrepel"><code>{ggrepel}</code></a>–by
                    labelling the individual data points–either as an additional
                    layer or as a
                    standalone plot (I didn’t think the summarized
                    <code>cyl</code> estimates added much so I
                    dropped the mean line/points).
                </p>
                <pre class="r"><code>## - add row names as make variable
## - add noise to cyl for spacing (store as cyl2)
## - plot and format labels with ggrepel
## - adjust x-axis labels
## - specify custom fill colors
mtcars %&gt;%
  mutate(make = row.names(mtcars),
    cyl2 = case_when(
      cyl == 4 ~ cyl - runif(1, .25, .5),
      cyl == 6 ~ cyl - runif(1, .00, .1),
      cyl == 8 ~ cyl + runif(1, .75, 1.25),
      TRUE ~ cyl
    )) %&gt;%
  ggplot(aes(x = cyl2, y = mpg)) +
  ggrepel::geom_label_repel(aes(fill = factor(cyl), label = make),
    family = &quot;Roboto Condensed Light&quot;, label.padding = 0.2, label.size = .25,
    min.segment.length = 100, color = &quot;black&quot;, size = 3.4) +
  my_theme() +
  my_labs() +
  scale_x_continuous(breaks = c(4, 6, 8)) +
  scale_fill_manual(values = c(&quot;#efd0ef&quot;, &quot;#d0efd0&quot;, &quot;#d0daef&quot;)) +
  my_save(&quot;img/tick-marks-final.png&quot;)</code></pre>
                <p style="align:center">
                    <img src="../../img/tick-marks-final.png">
                </p>
                <p>As you can see in the code chunk above, I also added some
                    additional noise to
                    the <code>cyl</code> variable to help out
                    <code>{ggrepel}</code>’s spacing algorithm. The approach
                    made it possible to plot <em>and label</em> each car in the
                    data set without overloading
                    or distracting the image with too much information. So, now,
                    not only does the
                    image convey the pattern between <code>mpg</code> and
                    <code>cyl</code>, but it does so in a way that
                    more people can recognize ( <em>4-cylinders</em> is less
                    meaningful than <em>Honda Civic</em>, for example),
                    while arguably being even more visually pleasing.
                </p>
            </div>
            <div id="notes" class="section level2">
                <h2>Notes</h2>
                <p><sup>1</sup> I knew just enough to read in data,
                    do some <a href="http://lavaan.ugent.be/">structural
                        equation modeling</a>, and
                    generate some simple plots via <code>base::plot()</code> and
                    <code>base::histogram()</code>.
                </p>
            </div>
        </article>
        <footer class="post-footer">

            <ul class="post-tags">

                <li><a href="../../tags/ggplot2"><span
                            class="tag">Ggplot2</span></a></li>

                <li><a href="../../tags/dataviz"><span
                            class="tag">Dataviz</span></a></li>

                <li><a href="../../tags/ggrepel"><span
                            class="tag">Ggrepel</span></a></li>

            </ul>

            <p class="post-copyright">
                © Michael W. Kearney 2018This post was published
                <strong>425</strong> days ago, content in the post may be
                inaccurate, even wrong now, please take risk yourself.
            </p>
        </footer>

        <div id="disqus_thread"></div>
        <script>
            var disqus_config = function () {



            };
            (function () {
                if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
                    document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
                    return;
                }
                var d = document, s = d.createElement('script'); s.async = true;
                s.src = '//' + "kearneymw" + '.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a
                href="https://disqus.com/?ref_noscript">comments powered by
                Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by
            <span class="logo-disqus">Disqus</span></a>


    </section>
    <footer class="site-footer">
        <p>© 2017-2019 Michael W. Kearney</p>

    </footer>



    <script async
        src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
    <script async
        src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="../../highlight/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
    <script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

    <script src="../../js/bundle.js"></script>
    <script src="../../highlight/highlight.pack.js"></script>


    <script>
        window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
        ga('create', 'UA-64959413-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script async src='//www.google-analytics.com/analytics.js'></script>





</body>

</html>